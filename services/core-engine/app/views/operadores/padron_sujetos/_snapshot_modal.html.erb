<%= turbo_frame_tag "snapshot_modal", data: { controller: "snapshot-modal" } do %>
  <div class="modal-overlay modal-overlay--snapshot" id="snapshot_modal_backdrop" role="dialog" aria-modal="true" aria-labelledby="snapshot_modal_title" data-action="click->snapshot-modal#close">
    <div class="modal-content modal-content--detail" data-action="click->snapshot-modal#stopPropagation">
      <header class="modal-header">
        <h2 id="snapshot_modal_title" class="modal-title">Estado del sujeto hasta este evento (solo lectura)</h2>
        <button type="button" class="modal-close" aria-label="Cerrar" data-action="click->snapshot-modal#close">×</button>
      </header>
      <div class="modal-body">
        <% s = @snapshot %>
        <section class="card card--spaced">
          <h3 class="card__title card__title--sm">Identidad</h3>
          <dl class="dl-list">
            <dt>Razón social</dt>
            <dd><%= s.legal_name.presence || "—" %></dd>
            <dt>Nombre de fantasía</dt>
            <dd><%= s.trade_name.presence || "—" %></dd>
            <dt>CUIT / N.º fiscal</dt>
            <dd><%= s.tax_id.presence || "—" %></dd>
            <dt>Estado</dt>
            <dd><%= s.status.presence || "—" %></dd>
            <dt>Versión (evento)</dt>
            <dd><%= s.version %></dd>
          </dl>
        </section>
        <section class="card card--spaced">
          <h3 class="card__title card__title--sm">Domicilio físico</h3>
          <% if s.address_line.present? || s.address_locality.present? || s.address_province.present? %>
            <p class="address-block"><%= [s.address_line, s.address_locality, s.address_province].compact.join(", ") %></p>
          <% else %>
            <p class="form-field__hint">Sin domicilio.</p>
          <% end %>
        </section>
        <section class="card card--spaced">
          <h3 class="card__title card__title--sm">Medios de contacto</h3>
          <% entries = s.contact_entries.presence || [] %>
          <% if entries.any? %>
            <ul class="contact-list">
              <% entries.each do |ce| %>
                <% type = (ce["type"] || ce[:type]).to_s %>
                <% value = (ce["value"] || ce[:value]).to_s %>
                <li><strong><%= type.presence || "—" %>:</strong> <%= value %></li>
              <% end %>
            </ul>
          <% else %>
            <p class="form-field__hint">Sin contactos.</p>
          <% end %>
        </section>
      </div>
      <footer class="modal-footer">
        <button type="button" class="btn btn--secondary" data-action="click->snapshot-modal#close">Cerrar</button>
      </footer>
    </div>
  </div>
<% end %>
